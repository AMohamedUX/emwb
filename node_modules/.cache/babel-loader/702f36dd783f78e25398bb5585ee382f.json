{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar react_1 = require(\"react\");\n\nvar actions_1 = require(\"@shopify/app-bridge/actions\");\n\nvar globals_1 = require(\"./globals\");\n\nfunction useRoutePropagation(app, location) {\n  var history = react_1.useMemo(function () {\n    return actions_1.History.create(app);\n  }, [app]);\n  react_1.useEffect(function () {\n    var selfWindow = globals_1.getSelfWindow();\n    var topWindow = globals_1.getTopWindow();\n    var renderedInTheTopWindow = selfWindow === topWindow;\n    var renderedInAModal = selfWindow.name === globals_1.MODAL_IFRAME_NAME;\n\n    if (renderedInTheTopWindow || renderedInAModal) {\n      return;\n    }\n\n    var normalizedLocation = getNormalizedURL(location);\n    /*\n      We delete this param that ends up unnecassarily stuck on\n      the iframe due to oauth when propagating up.\n    */\n\n    normalizedLocation.searchParams.delete('hmac');\n    var pathname = normalizedLocation.pathname,\n        search = normalizedLocation.search,\n        hash = normalizedLocation.hash;\n    var locationStr = \"\" + pathname + search + hash;\n    history.dispatch(actions_1.History.Action.REPLACE, locationStr);\n  }, [history, location]);\n}\n\nexports.default = useRoutePropagation;\n\nfunction getNormalizedURL(location) {\n  var origin = globals_1.getOrigin();\n\n  if (typeof location === 'string') {\n    return new URL(location, origin);\n  }\n\n  var pathname = location.pathname,\n      search = location.search,\n      hash = location.hash;\n  return new URL(\"\" + pathname + search + hash, origin);\n}","map":{"version":3,"sources":["/Users/ayubmohamed/emwb/node_modules/@shopify/react-shopify-app-route-propagator/dist/src/hook.js"],"names":["Object","defineProperty","exports","value","react_1","require","actions_1","globals_1","useRoutePropagation","app","location","history","useMemo","History","create","useEffect","selfWindow","getSelfWindow","topWindow","getTopWindow","renderedInTheTopWindow","renderedInAModal","name","MODAL_IFRAME_NAME","normalizedLocation","getNormalizedURL","searchParams","delete","pathname","search","hash","locationStr","dispatch","Action","REPLACE","default","origin","getOrigin","URL"],"mappings":"AAAA;;AACAA,MAAM,CAACC,cAAP,CAAsBC,OAAtB,EAA+B,YAA/B,EAA6C;AAAEC,EAAAA,KAAK,EAAE;AAAT,CAA7C;;AACA,IAAIC,OAAO,GAAGC,OAAO,CAAC,OAAD,CAArB;;AACA,IAAIC,SAAS,GAAGD,OAAO,CAAC,6BAAD,CAAvB;;AACA,IAAIE,SAAS,GAAGF,OAAO,CAAC,WAAD,CAAvB;;AACA,SAASG,mBAAT,CAA6BC,GAA7B,EAAkCC,QAAlC,EAA4C;AACxC,MAAIC,OAAO,GAAGP,OAAO,CAACQ,OAAR,CAAgB,YAAY;AAAE,WAAON,SAAS,CAACO,OAAV,CAAkBC,MAAlB,CAAyBL,GAAzB,CAAP;AAAuC,GAArE,EAAuE,CAACA,GAAD,CAAvE,CAAd;AACAL,EAAAA,OAAO,CAACW,SAAR,CAAkB,YAAY;AAC1B,QAAIC,UAAU,GAAGT,SAAS,CAACU,aAAV,EAAjB;AACA,QAAIC,SAAS,GAAGX,SAAS,CAACY,YAAV,EAAhB;AACA,QAAIC,sBAAsB,GAAGJ,UAAU,KAAKE,SAA5C;AACA,QAAIG,gBAAgB,GAAGL,UAAU,CAACM,IAAX,KAAoBf,SAAS,CAACgB,iBAArD;;AACA,QAAIH,sBAAsB,IAAIC,gBAA9B,EAAgD;AAC5C;AACH;;AACD,QAAIG,kBAAkB,GAAGC,gBAAgB,CAACf,QAAD,CAAzC;AACA;AACR;AACA;AACA;;AACQc,IAAAA,kBAAkB,CAACE,YAAnB,CAAgCC,MAAhC,CAAuC,MAAvC;AACA,QAAIC,QAAQ,GAAGJ,kBAAkB,CAACI,QAAlC;AAAA,QAA4CC,MAAM,GAAGL,kBAAkB,CAACK,MAAxE;AAAA,QAAgFC,IAAI,GAAGN,kBAAkB,CAACM,IAA1G;AACA,QAAIC,WAAW,GAAG,KAAKH,QAAL,GAAgBC,MAAhB,GAAyBC,IAA3C;AACAnB,IAAAA,OAAO,CAACqB,QAAR,CAAiB1B,SAAS,CAACO,OAAV,CAAkBoB,MAAlB,CAAyBC,OAA1C,EAAmDH,WAAnD;AACH,GAjBD,EAiBG,CAACpB,OAAD,EAAUD,QAAV,CAjBH;AAkBH;;AACDR,OAAO,CAACiC,OAAR,GAAkB3B,mBAAlB;;AACA,SAASiB,gBAAT,CAA0Bf,QAA1B,EAAoC;AAChC,MAAI0B,MAAM,GAAG7B,SAAS,CAAC8B,SAAV,EAAb;;AACA,MAAI,OAAO3B,QAAP,KAAoB,QAAxB,EAAkC;AAC9B,WAAO,IAAI4B,GAAJ,CAAQ5B,QAAR,EAAkB0B,MAAlB,CAAP;AACH;;AACD,MAAIR,QAAQ,GAAGlB,QAAQ,CAACkB,QAAxB;AAAA,MAAkCC,MAAM,GAAGnB,QAAQ,CAACmB,MAApD;AAAA,MAA4DC,IAAI,GAAGpB,QAAQ,CAACoB,IAA5E;AACA,SAAO,IAAIQ,GAAJ,CAAQ,KAAKV,QAAL,GAAgBC,MAAhB,GAAyBC,IAAjC,EAAuCM,MAAvC,CAAP;AACH","sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar react_1 = require(\"react\");\nvar actions_1 = require(\"@shopify/app-bridge/actions\");\nvar globals_1 = require(\"./globals\");\nfunction useRoutePropagation(app, location) {\n    var history = react_1.useMemo(function () { return actions_1.History.create(app); }, [app]);\n    react_1.useEffect(function () {\n        var selfWindow = globals_1.getSelfWindow();\n        var topWindow = globals_1.getTopWindow();\n        var renderedInTheTopWindow = selfWindow === topWindow;\n        var renderedInAModal = selfWindow.name === globals_1.MODAL_IFRAME_NAME;\n        if (renderedInTheTopWindow || renderedInAModal) {\n            return;\n        }\n        var normalizedLocation = getNormalizedURL(location);\n        /*\n          We delete this param that ends up unnecassarily stuck on\n          the iframe due to oauth when propagating up.\n        */\n        normalizedLocation.searchParams.delete('hmac');\n        var pathname = normalizedLocation.pathname, search = normalizedLocation.search, hash = normalizedLocation.hash;\n        var locationStr = \"\" + pathname + search + hash;\n        history.dispatch(actions_1.History.Action.REPLACE, locationStr);\n    }, [history, location]);\n}\nexports.default = useRoutePropagation;\nfunction getNormalizedURL(location) {\n    var origin = globals_1.getOrigin();\n    if (typeof location === 'string') {\n        return new URL(location, origin);\n    }\n    var pathname = location.pathname, search = location.search, hash = location.hash;\n    return new URL(\"\" + pathname + search + hash, origin);\n}\n"]},"metadata":{},"sourceType":"script"}