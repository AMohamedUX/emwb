{"ast":null,"code":"import _objectWithoutProperties from \"/Users/ayubmohamed/emwb/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js\";\nimport _classCallCheck from \"/Users/ayubmohamed/emwb/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";\nimport _createClass from \"/Users/ayubmohamed/emwb/node_modules/@babel/runtime/helpers/esm/createClass.js\";\nimport _assertThisInitialized from \"/Users/ayubmohamed/emwb/node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js\";\nimport _inherits from \"/Users/ayubmohamed/emwb/node_modules/@babel/runtime/helpers/esm/inherits.js\";\nimport _createSuper from \"/Users/ayubmohamed/emwb/node_modules/@babel/runtime/helpers/esm/createSuper.js\";\nvar _excluded = [\"children\", \"className\", \"horizontal\", \"vertical\", \"shadow\", \"hint\", \"focusable\", \"onScrolledToBottom\"];\nimport React, { Component } from 'react';\nimport debounce from 'lodash/debounce';\nimport { classNames } from '../../utilities/css.js';\nimport { scrollable } from '../shared.js';\nimport { ScrollableContext } from './context.js';\nimport styles from './Scrollable.scss.js';\nimport { ScrollTo } from './components/ScrollTo/ScrollTo.js';\nimport { StickyManager } from '../../utilities/sticky-manager/sticky-manager.js';\nimport { StickyManagerContext } from '../../utilities/sticky-manager/context.js';\nvar MAX_SCROLL_DISTANCE = 100;\nvar DELTA_THRESHOLD = 0.2;\nvar DELTA_PERCENTAGE = 0.2;\nvar EVENTS_TO_LOCK = ['scroll', 'touchmove', 'wheel'];\nvar PREFERS_REDUCED_MOTION = prefersReducedMotion();\nvar LOW_RES_BUFFER = 2;\n\nvar Scrollable = /*#__PURE__*/function (_Component) {\n  _inherits(Scrollable, _Component);\n\n  var _super = _createSuper(Scrollable);\n\n  function Scrollable() {\n    var _this;\n\n    _classCallCheck(this, Scrollable);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _super.call.apply(_super, [this].concat(args));\n    _this.state = {\n      topShadow: false,\n      bottomShadow: false,\n      scrollPosition: 0,\n      canScroll: false\n    };\n    _this.stickyManager = new StickyManager();\n    _this.scrollArea = null;\n    _this.handleResize = debounce(function () {\n      _this.handleScroll();\n    }, 50, {\n      trailing: true\n    });\n\n    _this.setScrollArea = function (scrollArea) {\n      _this.scrollArea = scrollArea;\n    };\n\n    _this.handleScroll = function () {\n      var _assertThisInitialize = _assertThisInitialized(_this),\n          scrollArea = _assertThisInitialize.scrollArea;\n\n      var scrollPosition = _this.state.scrollPosition;\n      var _this$props = _this.props,\n          shadow = _this$props.shadow,\n          onScrolledToBottom = _this$props.onScrolledToBottom;\n\n      if (scrollArea == null) {\n        return;\n      }\n\n      var scrollTop = scrollArea.scrollTop,\n          clientHeight = scrollArea.clientHeight,\n          scrollHeight = scrollArea.scrollHeight;\n      var shouldBottomShadow = Boolean(shadow && !(scrollTop + clientHeight >= scrollHeight));\n      var shouldTopShadow = Boolean(shadow && scrollTop > 0 && scrollPosition > 0);\n      var canScroll = scrollHeight > clientHeight;\n      var hasScrolledToBottom = scrollHeight - scrollTop <= clientHeight + LOW_RES_BUFFER;\n\n      if (canScroll && hasScrolledToBottom && onScrolledToBottom) {\n        onScrolledToBottom();\n      }\n\n      _this.setState({\n        topShadow: shouldTopShadow,\n        bottomShadow: shouldBottomShadow,\n        scrollPosition: scrollTop,\n        canScroll: canScroll\n      });\n    };\n\n    _this.scrollHint = function () {\n      var _assertThisInitialize2 = _assertThisInitialized(_this),\n          scrollArea = _assertThisInitialize2.scrollArea;\n\n      if (scrollArea == null) {\n        return;\n      }\n\n      var clientHeight = scrollArea.clientHeight,\n          scrollHeight = scrollArea.scrollHeight;\n\n      if (PREFERS_REDUCED_MOTION || _this.state.scrollPosition > 0 || scrollHeight <= clientHeight) {\n        return;\n      }\n\n      var scrollDistance = scrollHeight - clientHeight;\n\n      _this.toggleLock();\n\n      _this.setState({\n        scrollPosition: scrollDistance > MAX_SCROLL_DISTANCE ? MAX_SCROLL_DISTANCE : scrollDistance\n      }, function () {\n        window.requestAnimationFrame(_this.scrollStep);\n      });\n    };\n\n    _this.scrollStep = function () {\n      _this.setState(function (_ref) {\n        var scrollPosition = _ref.scrollPosition;\n        var delta = scrollPosition * DELTA_PERCENTAGE;\n        return {\n          scrollPosition: delta < DELTA_THRESHOLD ? 0 : scrollPosition - delta\n        };\n      }, function () {\n        if (_this.state.scrollPosition > 0) {\n          window.requestAnimationFrame(_this.scrollStep);\n        } else {\n          _this.toggleLock(false);\n        }\n      });\n    };\n\n    _this.scrollToPosition = function (scrollY) {\n      _this.setState({\n        scrollPosition: scrollY\n      });\n    };\n\n    return _this;\n  }\n\n  _createClass(Scrollable, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this2 = this;\n\n      if (this.scrollArea == null) {\n        return;\n      }\n\n      this.stickyManager.setContainer(this.scrollArea);\n      this.scrollArea.addEventListener('scroll', function () {\n        window.requestAnimationFrame(_this2.handleScroll);\n      });\n      window.addEventListener('resize', this.handleResize);\n      window.requestAnimationFrame(function () {\n        _this2.handleScroll();\n\n        if (_this2.props.hint) {\n          _this2.scrollHint();\n        }\n      });\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      if (this.scrollArea == null) {\n        return;\n      }\n\n      this.scrollArea.removeEventListener('scroll', this.handleScroll);\n      window.removeEventListener('resize', this.handleResize);\n      this.stickyManager.removeScrollListener();\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate() {\n      var scrollPosition = this.state.scrollPosition;\n\n      if (scrollPosition && this.scrollArea && scrollPosition > 0) {\n        this.scrollArea.scrollTop = scrollPosition;\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$state = this.state,\n          topShadow = _this$state.topShadow,\n          bottomShadow = _this$state.bottomShadow,\n          canScroll = _this$state.canScroll;\n\n      var _this$props2 = this.props,\n          children = _this$props2.children,\n          className = _this$props2.className,\n          horizontal = _this$props2.horizontal,\n          _this$props2$vertical = _this$props2.vertical,\n          vertical = _this$props2$vertical === void 0 ? true : _this$props2$vertical,\n          shadow = _this$props2.shadow,\n          hint = _this$props2.hint,\n          focusable = _this$props2.focusable,\n          onScrolledToBottom = _this$props2.onScrolledToBottom,\n          rest = _objectWithoutProperties(_this$props2, _excluded);\n\n      var finalClassName = classNames(className, styles.Scrollable, vertical && styles.vertical, horizontal && styles.horizontal, topShadow && styles.hasTopShadow, bottomShadow && styles.hasBottomShadow, vertical && canScroll && styles.verticalHasScrolling);\n      return /*#__PURE__*/React.createElement(ScrollableContext.Provider, {\n        value: this.scrollToPosition\n      }, /*#__PURE__*/React.createElement(StickyManagerContext.Provider, {\n        value: this.stickyManager\n      }, /*#__PURE__*/React.createElement(\"div\", Object.assign({\n        className: finalClassName\n      }, scrollable.props, rest, {\n        ref: this.setScrollArea // eslint-disable-next-line jsx-a11y/no-noninteractive-tabindex\n        ,\n        tabIndex: focusable ? 0 : undefined\n      }), children)));\n    }\n  }, {\n    key: \"toggleLock\",\n    value: function toggleLock() {\n      var shouldLock = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : true;\n      var scrollArea = this.scrollArea;\n\n      if (scrollArea == null) {\n        return;\n      }\n\n      EVENTS_TO_LOCK.forEach(function (eventName) {\n        if (shouldLock) {\n          scrollArea.addEventListener(eventName, prevent);\n        } else {\n          scrollArea.removeEventListener(eventName, prevent);\n        }\n      });\n    }\n  }], [{\n    key: \"forNode\",\n    value: function forNode(node) {\n      var closestElement = node.closest(scrollable.selector);\n      return closestElement instanceof HTMLElement ? closestElement : document;\n    }\n  }]);\n\n  return Scrollable;\n}(Component);\n\nScrollable.ScrollTo = ScrollTo;\n\nfunction prevent(evt) {\n  evt.preventDefault();\n}\n\nfunction prefersReducedMotion() {\n  try {\n    return window.matchMedia('(prefers-reduced-motion: reduce)').matches;\n  } catch (err) {\n    return false;\n  }\n}\n\nexport { Scrollable };","map":{"version":3,"sources":["/Users/ayubmohamed/emwb/node_modules/@shopify/polaris/build/esm/components/Scrollable/Scrollable.js"],"names":["React","Component","debounce","classNames","scrollable","ScrollableContext","styles","ScrollTo","StickyManager","StickyManagerContext","MAX_SCROLL_DISTANCE","DELTA_THRESHOLD","DELTA_PERCENTAGE","EVENTS_TO_LOCK","PREFERS_REDUCED_MOTION","prefersReducedMotion","LOW_RES_BUFFER","Scrollable","args","state","topShadow","bottomShadow","scrollPosition","canScroll","stickyManager","scrollArea","handleResize","handleScroll","trailing","setScrollArea","props","shadow","onScrolledToBottom","scrollTop","clientHeight","scrollHeight","shouldBottomShadow","Boolean","shouldTopShadow","hasScrolledToBottom","setState","scrollHint","scrollDistance","toggleLock","window","requestAnimationFrame","scrollStep","delta","scrollToPosition","scrollY","setContainer","addEventListener","hint","removeEventListener","removeScrollListener","children","className","horizontal","vertical","focusable","rest","finalClassName","hasTopShadow","hasBottomShadow","verticalHasScrolling","createElement","Provider","value","Object","assign","ref","tabIndex","undefined","shouldLock","forEach","eventName","prevent","node","closestElement","closest","selector","HTMLElement","document","evt","preventDefault","matchMedia","matches","err"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport debounce from 'lodash/debounce';\nimport { classNames } from '../../utilities/css.js';\nimport { scrollable } from '../shared.js';\nimport { ScrollableContext } from './context.js';\nimport styles from './Scrollable.scss.js';\nimport { ScrollTo } from './components/ScrollTo/ScrollTo.js';\nimport { StickyManager } from '../../utilities/sticky-manager/sticky-manager.js';\nimport { StickyManagerContext } from '../../utilities/sticky-manager/context.js';\n\nconst MAX_SCROLL_DISTANCE = 100;\nconst DELTA_THRESHOLD = 0.2;\nconst DELTA_PERCENTAGE = 0.2;\nconst EVENTS_TO_LOCK = ['scroll', 'touchmove', 'wheel'];\nconst PREFERS_REDUCED_MOTION = prefersReducedMotion();\nconst LOW_RES_BUFFER = 2;\nclass Scrollable extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      topShadow: false,\n      bottomShadow: false,\n      scrollPosition: 0,\n      canScroll: false\n    };\n    this.stickyManager = new StickyManager();\n    this.scrollArea = null;\n    this.handleResize = debounce(() => {\n      this.handleScroll();\n    }, 50, {\n      trailing: true\n    });\n\n    this.setScrollArea = scrollArea => {\n      this.scrollArea = scrollArea;\n    };\n\n    this.handleScroll = () => {\n      const {\n        scrollArea\n      } = this;\n      const {\n        scrollPosition\n      } = this.state;\n      const {\n        shadow,\n        onScrolledToBottom\n      } = this.props;\n\n      if (scrollArea == null) {\n        return;\n      }\n\n      const {\n        scrollTop,\n        clientHeight,\n        scrollHeight\n      } = scrollArea;\n      const shouldBottomShadow = Boolean(shadow && !(scrollTop + clientHeight >= scrollHeight));\n      const shouldTopShadow = Boolean(shadow && scrollTop > 0 && scrollPosition > 0);\n      const canScroll = scrollHeight > clientHeight;\n      const hasScrolledToBottom = scrollHeight - scrollTop <= clientHeight + LOW_RES_BUFFER;\n\n      if (canScroll && hasScrolledToBottom && onScrolledToBottom) {\n        onScrolledToBottom();\n      }\n\n      this.setState({\n        topShadow: shouldTopShadow,\n        bottomShadow: shouldBottomShadow,\n        scrollPosition: scrollTop,\n        canScroll\n      });\n    };\n\n    this.scrollHint = () => {\n      const {\n        scrollArea\n      } = this;\n\n      if (scrollArea == null) {\n        return;\n      }\n\n      const {\n        clientHeight,\n        scrollHeight\n      } = scrollArea;\n\n      if (PREFERS_REDUCED_MOTION || this.state.scrollPosition > 0 || scrollHeight <= clientHeight) {\n        return;\n      }\n\n      const scrollDistance = scrollHeight - clientHeight;\n      this.toggleLock();\n      this.setState({\n        scrollPosition: scrollDistance > MAX_SCROLL_DISTANCE ? MAX_SCROLL_DISTANCE : scrollDistance\n      }, () => {\n        window.requestAnimationFrame(this.scrollStep);\n      });\n    };\n\n    this.scrollStep = () => {\n      this.setState(({\n        scrollPosition\n      }) => {\n        const delta = scrollPosition * DELTA_PERCENTAGE;\n        return {\n          scrollPosition: delta < DELTA_THRESHOLD ? 0 : scrollPosition - delta\n        };\n      }, () => {\n        if (this.state.scrollPosition > 0) {\n          window.requestAnimationFrame(this.scrollStep);\n        } else {\n          this.toggleLock(false);\n        }\n      });\n    };\n\n    this.scrollToPosition = scrollY => {\n      this.setState({\n        scrollPosition: scrollY\n      });\n    };\n  }\n\n  static forNode(node) {\n    const closestElement = node.closest(scrollable.selector);\n    return closestElement instanceof HTMLElement ? closestElement : document;\n  }\n\n  componentDidMount() {\n    if (this.scrollArea == null) {\n      return;\n    }\n\n    this.stickyManager.setContainer(this.scrollArea);\n    this.scrollArea.addEventListener('scroll', () => {\n      window.requestAnimationFrame(this.handleScroll);\n    });\n    window.addEventListener('resize', this.handleResize);\n    window.requestAnimationFrame(() => {\n      this.handleScroll();\n\n      if (this.props.hint) {\n        this.scrollHint();\n      }\n    });\n  }\n\n  componentWillUnmount() {\n    if (this.scrollArea == null) {\n      return;\n    }\n\n    this.scrollArea.removeEventListener('scroll', this.handleScroll);\n    window.removeEventListener('resize', this.handleResize);\n    this.stickyManager.removeScrollListener();\n  }\n\n  componentDidUpdate() {\n    const {\n      scrollPosition\n    } = this.state;\n\n    if (scrollPosition && this.scrollArea && scrollPosition > 0) {\n      this.scrollArea.scrollTop = scrollPosition;\n    }\n  }\n\n  render() {\n    const {\n      topShadow,\n      bottomShadow,\n      canScroll\n    } = this.state;\n    const {\n      children,\n      className,\n      horizontal,\n      vertical = true,\n      shadow,\n      hint,\n      focusable,\n      onScrolledToBottom,\n      ...rest\n    } = this.props;\n    const finalClassName = classNames(className, styles.Scrollable, vertical && styles.vertical, horizontal && styles.horizontal, topShadow && styles.hasTopShadow, bottomShadow && styles.hasBottomShadow, vertical && canScroll && styles.verticalHasScrolling);\n    return /*#__PURE__*/React.createElement(ScrollableContext.Provider, {\n      value: this.scrollToPosition\n    }, /*#__PURE__*/React.createElement(StickyManagerContext.Provider, {\n      value: this.stickyManager\n    }, /*#__PURE__*/React.createElement(\"div\", Object.assign({\n      className: finalClassName\n    }, scrollable.props, rest, {\n      ref: this.setScrollArea // eslint-disable-next-line jsx-a11y/no-noninteractive-tabindex\n      ,\n      tabIndex: focusable ? 0 : undefined\n    }), children)));\n  }\n\n  toggleLock(shouldLock = true) {\n    const {\n      scrollArea\n    } = this;\n\n    if (scrollArea == null) {\n      return;\n    }\n\n    EVENTS_TO_LOCK.forEach(eventName => {\n      if (shouldLock) {\n        scrollArea.addEventListener(eventName, prevent);\n      } else {\n        scrollArea.removeEventListener(eventName, prevent);\n      }\n    });\n  }\n\n}\nScrollable.ScrollTo = ScrollTo;\n\nfunction prevent(evt) {\n  evt.preventDefault();\n}\n\nfunction prefersReducedMotion() {\n  try {\n    return window.matchMedia('(prefers-reduced-motion: reduce)').matches;\n  } catch (err) {\n    return false;\n  }\n}\n\nexport { Scrollable };\n"]},"metadata":{},"sourceType":"module"}